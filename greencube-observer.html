<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta tags -->
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta name="description" content="LEO SAT Observer" />
    <meta name="author" content="https://dxer.site" />
    <meta charset="utf-8">
    <title>GreenCube Observer</title>
    
    <!-- Leaflet dependencies -->
    <script type="text/javascript" src="https://unpkg.com/leaflet@latest/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@latest/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet.vectorgrid@latest/dist/Leaflet.VectorGrid.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/text-image/dist/text-image.js"></script>
    <script src="https://ha8tks.github.io/Leaflet.CQzones/src/L.CQzones.js"></script>
    <script src="https://ha8tks.github.io/Leaflet.ITUzones/src/L.ITUzones.js"></script>
    <script src="https://ha8tks.github.io/Leaflet.Maidenhead/src/L.Maidenhead.js"></script>

    <!-- MarkerCluster plugin -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

    <script src="leaflet/Leaflet.greatCircle.js"></script>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <!-- Professional font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
      html, body {
        height: 100%;
        padding: 0;
        margin: 0;
        font-family: 'Inter', Arial, sans-serif;
      }
      #map {
        height: 100%;
      }

      .floating {
        position: absolute;
        top: 20px;
        left: 20px;
        z-index: 1000;
        background-color: rgba(255, 255, 255, 0.9);
        padding: 14px 18px;
        border-radius: 10px;
        box-shadow: 0px 0px 12px rgba(0, 0, 0, 0.35);
        min-width: 200px;
      }

        /* Leaderboard Widget */
        .leaderboard-widget {
          position: absolute;
          bottom: 20px;
          left: 20px;
          z-index: 1000;
          background-color: rgba(255, 255, 255, 0.9);
          padding: 10px 14px;
          border-radius: 10px;
          box-shadow: 0px 0px 12px rgba(0, 0, 0, 0.35);
          width: 180px;
          font-size: 13px;
        }

        .leaderboard-widget h2 {
          font-size: 14px;
          font-weight: 700;
          margin: 0 0 8px 0;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .leaderboard-widget h2 a {
          font-size: 11px;
          font-weight: 600;
          color: #0078d4;
          text-decoration: none;
        }

        .leaderboard-widget h2 a:hover {
          text-decoration: underline;
        }

        .leaderboard-widget ol {
          padding-left: 18px;
          margin: 0 0 8px 0;
        }

        .leaderboard-widget li {
          margin-bottom: 3px;
        }

        .hide-button {
          display: block;
          margin-top: 6px;
        }

        .show-button {
          position: absolute;
          bottom: 20px;
          left: 20px;
          z-index: 1000;
          background-color: #0078d4;
          color: white;
          border: none;
          border-radius: 6px;
          padding: 6px 10px;
          cursor: pointer;
          font-size: 12px;
          font-weight: 600;
          transition: background 0.2s ease;
          display: none;
        }

        .show-button:hover {
          background-color: #005fa3;
        }

        
      /* Header alignment */
      .floating h2 {
        display: flex;
        align-items: flex-start;
        font-weight: 700;
        font-size: 16px;
        margin: 0 0 10px 0;
        letter-spacing: 0.5px;
      }

      .floating h2 img {
        width: 28px;
        height: 28px;
        margin-right: 6px;
        margin-top: 2px;
      }

      .title-text {
        display: flex;
        flex-direction: column;
      }

      .title-line {
        display: flex;
        align-items: baseline;
      }

      .title-main {
        font-size: 16px;
        font-weight: 700;
      }

      .title-sub {
        font-size: 11px;
        font-weight: 500;
        text-align: right;
        margin-top: -2px;
        color: #333;
      }

      label {
        display: block;
        font-size: 13px;
        font-weight: 600;
        margin-bottom: 6px;
      }

      input[type="text"] {
        width: 75px;
        padding: 5px 6px;
        font-size: 13px;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-right: 6px;
      }

      button {
        background-color: #0078d4;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 6px 10px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 600;
        transition: background 0.2s ease;
      }

      button:hover {
        background-color: #005fa3;
      }

      .observer-buttons {
        display: flex;
        gap: 5px;
        margin-top: 10px;
      }
        .sat-label {
            background-color: rgba(255,255,255,0.8);
            border-radius: 3px;
            padding: 2px 4px;
            font-size: 12px;
            font-weight: bold;
            color: black;
            white-space: nowrap;
        }

      * { outline: none !important; }
      .notice-banner {
        position: absolute;
        bottom: 20px;
        right: 50px;
        z-index: 1000;
        background-color: #fff8e1;
        color: #333;
        border-left: 5px solid #ffcc00;
        box-shadow: 0px 2px 8px rgba(0,0,0,0.2);
        padding: 10px 12px 10px 10px;
        border-radius: 8px;
        font-size: 13px;
        display: flex;
        align-items: flex-start;
        gap: 8px;
        max-width: 280px;
        opacity: 1;
        transition: opacity 0.4s ease, transform 0.4s ease;
      }

      .notice-banner.hide {
        opacity: 0;
        transform: translateY(10px);
        pointer-events: none;
      }

      .notice-banner .warning-icon {
        flex-shrink: 0;
        color: #ff9800;
        margin-top: 2px;
      }

      .notice-text {
        line-height: 1.4;
      }

      .notice-close {
        background: transparent;
        border: none;
        color: #555;
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
        margin-left: auto;
        line-height: 1;
        padding: 0 4px;
        transition: color 0.2s ease;
      }

      .notice-close:hover {
        color: #000;
      }
    </style>
  </head>

  <body>
    <!-- Unified floating panel -->
    <div class="floating">
      <h2>
        <img src="img/gclogo.png" alt="GreenCube logo">
        <div class="title-text">
          <div class="title-sub">by SA5IKN</div>
          <div class="title-line">
            <span class="title-main">GreenCube Observer</span>
          </div>
        </div>
      </h2>

      <label for="grid-locator">Enter your Grid:</label>
      <input type="text" id="grid-locator" placeholder="e.g. JO89tt" maxlength="6">
      <button onclick="initMap(document.getElementById('grid-locator').value)">Plot your Range</button>

      <div class="observer-buttons">
          <button onclick="window.open('https://dxer.site', '_blank')" style="padding:6px;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 3l9 9h-3v9h-12v-9h-3l9-9z"/>
            </svg>
          </button>
          <button onclick="window.open('https://dxer.site/greencube-io117-statistics-dxcc.html', '_blank')" style="padding:6px;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M3 3h2v18H3V3zm16 10h2v8h-2v-8zM11 8h2v13h-2V8zM7 13h2v8H7v-8zm8-6h2v14h-2V7z"/>
            </svg>
          </button>

        <button onclick="window.open('https://dxer.site/leo-satellite-observer.html', '_blank')">LEO</button>
        <button onclick="window.open('https://dxer.site/qo-100-satellite-observer.html', '_blank')">GEO</button>
        <button onclick="window.open('https://dxer.site/eme-observer/', '_blank')">EME</button>
      </div>
    </div>

    <!-- Map container -->
    <div id="map"></div>

    <!-- Leaderboard Widget -->
    <div class="leaderboard-widget" id="leaderboard">
      <h2>
        Open Data Leaders
        <a href="https://dxer.site/greencube-leaderboard.html" target="_blank">&nbsp;ALL</a>
      </h2>
      <ol id="leaderboard-list">
        <li>Loading...</li>
      </ol>
      <button class="hide-button" onclick="toggleLeaderboard()">Hide</button>
    </div>

    <!-- Show Button -->
    <button class="show-button" onclick="toggleLeaderboard()">Show Leaders</button>

    
    <script>
        (function(_0x282ea8,_0x579ae6){const _0x5afa96=_0x3d3c,_0x392b72=_0x282ea8();while(!![]){try{const _0x29817c=-parseInt(_0x5afa96(0xbe))/0x1*(-parseInt(_0x5afa96(0xcf))/0x2)+parseInt(_0x5afa96(0xee))/0x3+parseInt(_0x5afa96(0xab))/0x4+-parseInt(_0x5afa96(0xb6))/0x5*(parseInt(_0x5afa96(0xac))/0x6)+-parseInt(_0x5afa96(0xe7))/0x7*(-parseInt(_0x5afa96(0xcb))/0x8)+-parseInt(_0x5afa96(0xc5))/0x9+parseInt(_0x5afa96(0xb2))/0xa*(-parseInt(_0x5afa96(0xad))/0xb);if(_0x29817c===_0x579ae6)break;else _0x392b72['push'](_0x392b72['shift']());}catch(_0x1dd3d1){_0x392b72['push'](_0x392b72['shift']());}}}(_0x3253,0x301ec));var map,layerGroup;const BLINKING_GIF_URL='img/rover1.gif?v=1';function destinationPoint(_0x253b83,_0x206a0c,_0x5b34ee,_0x5b08a1){const _0x426c09=_0x3d3c,_0x5ab9d7=0x6136b8,_0x55cd9f=Math['PI']/0xb4,_0x97bc3d=0xb4/Math['PI'];_0x253b83=_0x253b83*_0x55cd9f,_0x206a0c=_0x206a0c*_0x55cd9f,_0x5b08a1=_0x5b08a1*_0x55cd9f;const _0x48dbae=_0x5b34ee/_0x5ab9d7,_0x1d9f69=Math['asin'](Math[_0x426c09(0xbd)](_0x253b83)*Math[_0x426c09(0xd2)](_0x48dbae)+Math[_0x426c09(0xd2)](_0x253b83)*Math['sin'](_0x48dbae)*Math['cos'](_0x5b08a1)),_0x83b333=_0x206a0c+Math[_0x426c09(0xae)](Math[_0x426c09(0xbd)](_0x5b08a1)*Math[_0x426c09(0xbd)](_0x48dbae)*Math['cos'](_0x253b83),Math[_0x426c09(0xd2)](_0x48dbae)-Math[_0x426c09(0xbd)](_0x253b83)*Math[_0x426c09(0xbd)](_0x1d9f69));return{'lat':_0x1d9f69*_0x97bc3d,'lng':_0x83b333*_0x97bc3d};}function _0x3d3c(_0x5a3870,_0x429b61){const _0x325302=_0x3253();return _0x3d3c=function(_0x3d3c26,_0x1c394c){_0x3d3c26=_0x3d3c26-0xa9;let _0x3881ea=_0x325302[_0x3d3c26];return _0x3881ea;},_0x3d3c(_0x5a3870,_0x429b61);}function calculateCoordinates(_0x2835f9){const _0x1f70cb=_0x3d3c;_0x2835f9=_0x2835f9[_0x1f70cb(0xcc)]();var _0xf8d671=/^[A-R]{2}\d{2}[A-X]{2}$/i;if(!_0xf8d671[_0x1f70cb(0xe3)](_0x2835f9))return alert(_0x1f70cb(0xb3)),null;var _0x3fa200=-0x5a+(_0x2835f9[_0x1f70cb(0xdb)](0x1)-0x41)*0xa+parseInt(_0x2835f9[_0x1f70cb(0xdd)](0x3))+(_0x2835f9[_0x1f70cb(0xdb)](0x5)-0x41)/0x18+0x1/0x30,_0x56a781=-0xb4+(_0x2835f9['charCodeAt'](0x0)-0x41)*0x14+parseInt(_0x2835f9['charAt'](0x2))*0x2+(_0x2835f9[_0x1f70cb(0xdb)](0x4)-0x41)/0xc+0x1/0x18;return{'lat':_0x3fa200,'lng':_0x56a781};}function _0x3253(){const _0xcfeb81=['#FF0000','\x22\x20target=\x22_blank\x22><b>','forEach','sin','1EDuRJD','control','greatCircle','zoom','output_filtered_all.txt','announcements_filtered.txt','join','1534104DFgJdN','replace','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20GRID\x20locator:\x20','Map\x20data\x20©\x20<a\x20href=\x22https://openstreetmap.org\x22>OpenStreetMap</a>\x20contributors','split','2377688fapSpR','toUpperCase','push','trim','614046VQXUnN','addLayer','radius','cos','grid','.000Z','img/car.png','https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png','marker','earliest','latest','match','charCodeAt','<hr\x20style=\x27margin:4px\x200;\x27>','charAt','icon','IO-117','markerIcon','toISOString','angle','test','bindPopup','lng','exec','7OiJlls','</a></div>','endsWith','sat-label','lat','text','map','254250vUqDXm','</b></a><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20First\x20heard:\x20','img/ship_s.png','211672uXbGea','348fpdXNg','10736erqfYx','atan2','callsign','\x20UTC','then','2480jgevJQ','Invalid\x20grid\x20locator\x20format.\x20Please\x20enter\x20a\x20valid\x206-character\x20grid\x20locator.','label','divIcon','11405gBIbPP','layers','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Last\x20heard:\x20','addTo'];_0x3253=function(){return _0xcfeb81;};return _0x3253();}function initMap(_0x1033b3){const _0x5ca789=_0x3d3c;if(map)map['remove']();map=L['map'](_0x5ca789(0xed),{'center':[0x0,0x0],'zoom':0x2,'zoomControl':![],'attributionControl':!![]}),L['control'][_0x5ca789(0xc1)]({'position':'bottomright'})[_0x5ca789(0xb9)](map);var _0x4fa144=L['tileLayer'](_0x5ca789(0xd6),{'attribution':_0x5ca789(0xc9),'minZoom':0x0,'maxZoom':0x14})[_0x5ca789(0xb9)](map),_0x163b95=L['cqzones'](),_0x618f0f=L['maidenhead']();_0x618f0f[_0x5ca789(0xb9)](map),L[_0x5ca789(0xbf)][_0x5ca789(0xb7)]({'Map':_0x4fa144},{'<span\x20style=\x27color:\x20black\x27>CQ\x20Zones</span>':_0x163b95,'<span\x20style=\x27color:\x20black\x27>QTH\x20Locators</span>':_0x618f0f})[_0x5ca789(0xb9)](map);var _0x2c8d09=L['markerClusterGroup']({'spiderfyOnMaxZoom':!![],'showCoverageOnHover':![],'maxClusterRadius':0x1});fetch(_0x5ca789(0xc3))[_0x5ca789(0xb1)](_0x23ad27=>_0x23ad27['text']())[_0x5ca789(0xb1)](_0x101d7=>{const _0x29ab94=_0x5ca789,_0x1cb3f=_0x101d7[_0x29ab94(0xce)]()['split']('\x0a');_0x1cb3f[_0x29ab94(0xbc)](_0x177a16=>{const _0x34b643=_0x29ab94,_0x5e981c=_0x177a16['match'](/Coordinates: \((.*), (.*)\)/),_0x503fe6=_0x177a16[_0x34b643(0xda)](/Time: ([^,]*)/),_0x4f2eb6=_0x177a16['match'](/Callsign: ([^,]*)/);if(!_0x5e981c||!_0x503fe6||!_0x4f2eb6)return;const _0x473101=parseFloat(_0x5e981c[0x1]),_0x3461ff=parseFloat(_0x5e981c[0x2]),_0x573f10=new Date(_0x503fe6[0x1]);if(_0x573f10<=new Date())return;const _0x4d1164=L[_0x34b643(0xd7)]([_0x473101,_0x3461ff],{'icon':L[_0x34b643(0xde)]({'iconUrl':BLINKING_GIF_URL,'iconSize':[0x10,0x10],'iconAnchor':[0xa,0xa]})});_0x4d1164[_0x34b643(0xe4)]('<div><a\x20href=\x22https://hams.at/alerts\x22\x20target=\x22_blank\x22>'+_0x4f2eb6[0x1]+_0x34b643(0xe8)),_0x2c8d09[_0x34b643(0xd0)](_0x4d1164);}),fetch(_0x29ab94(0xc2))[_0x29ab94(0xb1)](_0x992b0c=>_0x992b0c[_0x29ab94(0xec)]())[_0x29ab94(0xb1)](_0x6d4988=>{const _0x208cbe=_0x29ab94,_0x76b60b=/Earliest:\s*([^,]+),\s*Latest:\s*([^,]+),\s*Callsign:\s*([^,]+),\s*Grid locator:\s*([^,]+),\s*Coordinates:\s*\(([^,]+),\s*([^)]+)\)/g,_0x5722f7={};let _0x25e9e6;while((_0x25e9e6=_0x76b60b[_0x208cbe(0xe6)](_0x6d4988))!==null){const _0x3be516=_0x25e9e6[0x1],_0x4353ad=_0x25e9e6[0x2],_0x5071af=_0x25e9e6[0x3],_0x3582de=_0x25e9e6[0x4],_0x31cd10=parseFloat(_0x25e9e6[0x5]),_0x444388=parseFloat(_0x25e9e6[0x6]),_0xd0e428=_0x31cd10+','+_0x444388;if(!_0x5722f7[_0xd0e428])_0x5722f7[_0xd0e428]=[];let _0x3ae6d8='img/176096839586434633.png';if(_0x5071af['endsWith']('/MM'))_0x3ae6d8=_0x208cbe(0xaa);else(_0x5071af[_0x208cbe(0xe9)]('/P')||_0x5071af[_0x208cbe(0xe9)]('/R'))&&(_0x3ae6d8=_0x208cbe(0xd5));_0x5722f7[_0xd0e428][_0x208cbe(0xcd)]({'callsign':_0x5071af,'grid':_0x3582de,'earliest':_0x3be516,'latest':_0x4353ad,'markerIcon':_0x3ae6d8});}for(const _0x50d5d2 in _0x5722f7){const [_0x1b2bec,_0x36958b]=_0x50d5d2[_0x208cbe(0xca)](','),_0x19ceec=_0x5722f7[_0x50d5d2],_0x41be6b=_0x19ceec[0x0][_0x208cbe(0xe0)],_0x1ef981=L[_0x208cbe(0xd7)]([_0x1b2bec,_0x36958b],{'icon':L[_0x208cbe(0xde)]({'iconUrl':_0x41be6b,'iconSize':[0x10,0x10],'iconAnchor':[0xa,0xa]}),'title':_0x19ceec[_0x208cbe(0xed)](_0x5c5ef2=>_0x5c5ef2['callsign'])[_0x208cbe(0xc4)](',\x20')}),_0x1b21e0=_0x19ceec[_0x208cbe(0xed)](_0x44e934=>{const _0x1bf4d2=_0x208cbe,_0x4d0361=new Date(_0x44e934[_0x1bf4d2(0xd8)])['toISOString']()['replace']('T','\x20')['replace']('.000Z','\x20UTC'),_0x15ffd9=new Date(_0x44e934[_0x1bf4d2(0xd9)])[_0x1bf4d2(0xe1)]()[_0x1bf4d2(0xc6)]('T','\x20')[_0x1bf4d2(0xc6)](_0x1bf4d2(0xd4),_0x1bf4d2(0xb0));return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22line-height:1.4;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22https://www.qrz.com/db/'+_0x44e934[_0x1bf4d2(0xaf)]+_0x1bf4d2(0xbb)+_0x44e934['callsign']+_0x1bf4d2(0xa9)+_0x4d0361+_0x1bf4d2(0xb8)+_0x15ffd9+_0x1bf4d2(0xc8)+_0x44e934[_0x1bf4d2(0xd3)]+_0x1bf4d2(0xc7);})[_0x208cbe(0xc4)](_0x208cbe(0xdc));_0x1ef981['bindPopup'](_0x1b21e0),_0x2c8d09['addLayer'](_0x1ef981);}map[_0x208cbe(0xd0)](_0x2c8d09);});});if(_0x1033b3){const _0x192679=calculateCoordinates(_0x1033b3);if(!_0x192679)return;L[_0x5ca789(0xd7)]([_0x192679[_0x5ca789(0xeb)],_0x192679[_0x5ca789(0xe5)]],{'title':_0x1033b3})['addTo'](map);const _0x1405f8=[{'radius':0xc65d40,'label':_0x5ca789(0xdf),'angle':0xb9}];_0x1405f8[_0x5ca789(0xbc)](_0x257830=>{const _0x2c0755=_0x5ca789;L[_0x2c0755(0xc0)]([_0x192679['lat'],_0x192679['lng']],{'radius':_0x257830[_0x2c0755(0xd1)],'color':_0x257830['strokeColor']||_0x2c0755(0xba),'fillOpacity':_0x257830['fillOpacity']!==undefined?_0x257830['fillOpacity']:0.1,'weight':0x1,'wrapElements':!![],'clipLat':0x55,'degStep':0.5,'maxCopies':-0x1})[_0x2c0755(0xb9)](map);const _0x228261=destinationPoint(_0x192679[_0x2c0755(0xeb)],_0x192679[_0x2c0755(0xe5)],_0x257830[_0x2c0755(0xd1)],_0x257830[_0x2c0755(0xe2)]-0x7d);L[_0x2c0755(0xd7)]([_0x228261[_0x2c0755(0xeb)],_0x228261['lng']],{'icon':L[_0x2c0755(0xb5)]({'className':_0x2c0755(0xea),'html':_0x257830[_0x2c0755(0xb4)],'iconSize':[0x28,0x14],'iconAnchor':[0x14,0xa]}),'interactive':![]})['addTo'](map);});}}initMap('');
    </script>
    <script>
    function hideNotice() {
      const banner = document.getElementById('noticeBanner');
      banner.classList.add('hide');
      setTimeout(() => banner.remove(), 500); // remove after fade-out
    }
    </script>
    <script src="leaderboard-l.js"></script>
    <!-- Historical Notice -->
    <div class="notice-banner" id="noticeBanner">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" class="warning-icon">
        <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
      </svg>
      <div class="notice-text">
        <strong>Note:</strong> IO-117 (GreenCube) ceased operations on 2024-08-25 following radiation damage sustained in the Van Allen belts. Data shown here represents <b>historical activity</b>.
      </div>
      <button class="notice-close" onclick="hideNotice()">✕</button>
    </div>
  </body>
</html>
