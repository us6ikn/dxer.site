<html>
<head>
<title>Moonrise and Moonset Times</title>
<meta charset="utf-8" />
<script language="JavaScript" src="observer.js"></script>
<script language="JavaScript" src="datetime.js"></script>
<script language="JavaScript" src="moon.js"></script>
<script language="JavaScript" src="util.js"></script>
<script language="JavaScript" src="math.js"></script>

<script>
// Observer object with defaults
var observer = {
  latitude: 0,
  longitude: 0,
  tz: 0,
  year: 2000,
  month: 1,
  day: 1,
  hours: 0,
  minutes: 0,
  seconds: 0
};

// Convert input to observer and calculate moon rise/set
function calculateMoonRiseSet() {
  var lat = parseFloat(document.getElementById("lat").value);
  var latDir = document.getElementById("latDir").value;
  var lon = parseFloat(document.getElementById("lon").value);
  var lonDir = document.getElementById("lonDir").value;
  var dateStr = document.getElementById("date").value; // expected YYYY-MM-DD
  var tzOffset = parseFloat(document.getElementById("tzOffset").value);

  observer.latitude = (latDir === "S") ? -lat : lat;
  observer.longitude = (lonDir === "W") ? -lon : lon;
  observer.tz = tzOffset * 60; // in minutes

  var parts = dateStr.split("-");
  if (parts.length !== 3) {
    alert("Please enter date in YYYY-MM-DD format.");
    return;
  }
  observer.year = parseInt(parts[0],10);
  observer.month = parseInt(parts[1],10);
  observer.day = parseInt(parts[2],10);
  observer.hours = 0;
  observer.minutes = 0;
  observer.seconds = 0;

  // Moon rise/set calculation: use moon.js function doMoon(observer, 0)
  // But that shows a lot; we want only rise/set times.
  // Let's call moonRiseSet(observer) if available, or use internal functions.
  // The original library likely has something like rise/set times in moon.js

  // If you have a function called moonRiseSet(observer) returning times, do:
  var riseSet = getMoonRiseSet(observer);

  var output = "";
  if (riseSet.rise !== null) {
    output += "Moonrise: " + riseSet.rise + " (local time)<br>";
  } else {
    output += "Moonrise: No moonrise on this date<br>";
  }
  if (riseSet.set !== null) {
    output += "Moonset: " + riseSet.set + " (local time)<br>";
  } else {
    output += "Moonset: No moonset on this date<br>";
  }
  document.getElementById("result").innerHTML = output;
}

// Dummy function to illustrate - you must replace this with actual moon rise/set calculation
function getMoonRiseSet(obs) {
  // The original moon.js has function doMoon(observer,mode)
  // mode=0 = one calculation for current date/time
  // We want to extract moonrise and moonset times.

  // Pseudo-code:
  // Use moon.js rise/set algorithm here for observer on the date

  // Since I can't see full moon.js here, let's just simulate
  // In real usage, call moonrise/moonset calculation functions here

  // Example returns time strings HH:MM:SS local time or null if no rise/set

  // For demonstration:
  return {
    rise: "19:23:45",
    set: "05:41:22"
  };
}
</script>
</head>
<body>
<h2>Moonrise and Moonset Calculator</h2>
<p>Enter your location, date, and time zone offset (hours from UTC):</p>

Latitude:
<input type="number" id="lat" step="0.01" value="51.5" style="width:70px">
<select id="latDir">
  <option value="N" selected>North</option>
  <option value="S">South</option>
</select>
<br>

Longitude:
<input type="number" id="lon" step="0.01" value="0" style="width:70px">
<select id="lonDir">
  <option value="E" selected>East</option>
  <option value="W">West</option>
</select>
<br>

Date (YYYY-MM-DD):
<input type="date" id="date" value="2025-06-15"><br>

Time Zone offset from UTC (hours, e.g. -5, 1, 2):
<input type="number" id="tzOffset" step="0.5" value="0" style="width:50px"><br><br>

<button onclick="calculateMoonRiseSet()">Calculate Moonrise and Moonset</button>

<hr>
<div id="result" style="font-weight:bold;"></div>

</body>
</html>
