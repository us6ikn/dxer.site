/*!
 * EMEastroLib — Earth-Moon-Earth Astronomy Library
 * © 2025 Max Romensky, SA5IKN. All rights reserved.
 * Based on J. Meeus (1988), 4th ed. and Duffett-Smith (1990)
 */ !function(){function $($,n,s,i,_){return 367*$-Math.floor(7*($+Math.floor((n+9)/12))/4)+Math.floor(275*n/9)+s+(i+_/60)/24-730531.5}function n($,n,s,i){return(100.46+.985647*$+n+15.04106864025*(s+i/60))%360*Math.PI/180}function s($){let n=$/36525;return(125.045-1934.14*n+.002071*n**2+n**3/45e4)%360}function i($){let n=$/36525,s=n**2,i=n**3,_=(134.963+477199*n+.008997*s+i/69700)%360*Math.PI/180,o=2*((297.85+445267*n-.00163*s+i/545900)%360)*Math.PI/180;return 1+(-20954*Math.cos(_)-3699*Math.cos(o-_)-2956*Math.cos(o))/385e3}function _($){let n=$/36525,s=n**2,i=n**3,_=((134.963+477199*n+.008997*s+i/69700)%360+360)%360*Math.PI/180,o=((93.2721+483202*n-.003403*s-i/3526e3)%360+360)%360,c=o*Math.PI/180;return[(5.128*Math.sin(c)+.2806*Math.sin(_+c)+.2777*Math.sin(_-c)+.1732*Math.sin(2*(((297.85+445267*n-.00163*s+i/545900)%360+360)%360)*Math.PI/180-c))*Math.PI/180,o]}function o($){let n=$/36525,s=n**2,i=n**3,_=((134.963+477199*n+.008997*s+i/69700)%360+360)%360*Math.PI/180,o=2*(((297.85+445267*n-.00163*s+i/545900)%360+360)%360)*Math.PI/180,c=((357.529+35999*n-1536e-7*s+i/2449e4)%360+360)%360*Math.PI/180;return((218.316+481268*n)%360+360)%360+(6.289*Math.sin(_)+1.274*Math.sin(o-_)+.6583*Math.sin(o)+.2136*Math.sin(2*_)-.1851*Math.sin(c)-.1143*Math.sin(2*(((93.2721+483202*n-.003403*s-i/3526e3)%360+360)%360*Math.PI/180))+.0588*Math.sin(o-2*_)+.0572*Math.sin(o-c-_)+.0533*Math.sin(o+_))}function c($,n,s){let i=$*Math.PI/180;return Math.atan2(Math.sin(i)*Math.cos(s)-Math.tan(n)*Math.sin(s),Math.cos(i))}window.EMEastroLib={topocentricLibration:function t(r,I,a,P,e,u,l){let f=$(r,I,a,P,e),L=n(f,l,P,e),b=s(f),E=b*Math.PI/180,g=i(f),[M,S]=_(f),d=o(f),A=d*Math.PI/180,T=(84381.448-46.815*(f/36525))/3600*Math.PI/180,h=c(d,M,T),k=h>=0?h:2*Math.PI+h,m=Math.asin(Math.sin(M)*Math.cos(T)+Math.cos(M)*Math.sin(T)*Math.sin(A)),p=((d-b)%360+360)%360*Math.PI/180,q=1.54242*Math.PI/180,v=Math.sin(p)*Math.cos(M)*Math.cos(q)-Math.sin(M)*Math.sin(q),x=Math.cos(p)*Math.cos(M),y=Math.atan2(v,x),K=-Math.sin(p)*Math.cos(M)*Math.sin(q)-Math.sin(M)*Math.cos(q),N=Math.asin(K),R=u*Math.PI/180,j=L-k,w=Math.sin(q)*Math.sin(E),z=Math.sin(q)*Math.cos(E)*Math.cos(T)-Math.cos(q)*Math.sin(T),B=Math.atan2(w,z);B<0&&(B+=2*Math.PI);let C=Math.asin(Math.sqrt(w**2+z**2)*Math.cos(h-B)/Math.cos(N)),D=Math.atan2(Math.cos(R)*Math.sin(j),Math.cos(m)*Math.sin(R)-Math.sin(m)*Math.cos(R)*Math.cos(j)),F=D>=0?D:2*Math.PI+D,G=Math.acos(Math.sin(m)*Math.sin(R)+Math.cos(m)*Math.cos(R)*Math.cos(j)),H=180*Math.asin(6378.14/(385e3*g))/Math.PI*(Math.sin(G)+.0084*Math.sin(2*G));return[180*N/Math.PI+H*Math.cos(F-C),(((180*y/Math.PI%360+360)%360-S+180)%360+360)%360-180+-H*Math.sin(F-C)/Math.cos(N)]},geocentricLibration:function n(c,t,r,I,a){let P=$(c,t,r,I,a),e=s(P);i(P);let[u,l]=_(P),f=o(P),L=((f-e)%360+360)%360*Math.PI/180,b=u,E=1.54242*Math.PI/180;return[180*Math.asin(-Math.sin(L)*Math.cos(b)*Math.sin(E)-Math.sin(b)*Math.cos(E))/Math.PI,(((180*Math.atan2(Math.sin(L)*Math.cos(b)*Math.cos(E)-Math.sin(b)*Math.sin(E),Math.cos(L)*Math.cos(b))/Math.PI%360+360)%360-l+180)%360+360)%360-180]},calculateLST:$,calculateLSTradians:n,calculateB74:s,calculateB78:i,calculateC80andB72:_,calculateB82:o,calculateC85:c},console.log("EMEastroLib \xa9 2025 Max Romensky, SA5IKN. All rights reserved.")}();
