<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10GHz EME Stations Statistics</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Fetch data from JSON files
        async function fetchData(file) {
            const response = await fetch(file);
            return await response.json();
        }

        // Function to extract antenna size (m) from antenna description
        function getAntennaSize(antennaStr) {
            let regex = /(\d+(\.\d+)?)(m|ft)/;
            let match = antennaStr.match(regex);
            if (match) {
                return parseFloat(match[1]);
            }
            return 0; // Default if no size is found
        }

        // Function to extract power (in W) from power description
        function getPower(powerStr) {
            let regex = /(\d+)(W|w)/;
            let match = powerStr.match(regex);
            if (match) {
                return parseInt(match[1]);
            }
            return 0; // Default if no power is found
        }

        // Helper function to compute the distribution of values (in percentages)
        function computeDistribution(values) {
            let distribution = {};
            values.forEach(value => {
                distribution[value] = (distribution[value] || 0) + 1;
            });
            let total = values.length;
            let percentageDistribution = {};
            for (let value in distribution) {
                percentageDistribution[value] = (distribution[value] / total) * 100;
            }
            return percentageDistribution;
        }

        // Setup the charts
        async function setupCharts() {
            // Load the two JSON files
            let data1 = await fetchData('output_2_10GHz.json');
            let data2 = await fetchData('output_2_10GHz_SK.json');
            let allData = [...data1, ...data2];

            // Get antenna sizes and power values
            let antennaSizes = allData.map(item => getAntennaSize(item.Antenna));
            let powerValues = allData.map(item => getPower(item.Power));

            // Compute distributions
            let antennaDistribution = computeDistribution(antennaSizes);
            let powerDistribution = computeDistribution(powerValues);

            // Create labels and data for the charts
            let antennaLabels = Object.keys(antennaDistribution);
            let antennaData = Object.values(antennaDistribution);

            let powerLabels = Object.keys(powerDistribution);
            let powerData = Object.values(powerDistribution);

            // Antenna Size Distribution Chart
            new Chart(document.getElementById('antennaChart'), {
                type: 'bar',
                data: {
                    labels: antennaLabels,
                    datasets: [{
                        label: 'Antenna Size Distribution (%)',
                        data: antennaData,
                        backgroundColor: 'rgba(255, 99, 132, 0.6)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, ticks: { stepSize: 10 } }
                    }
                }
            });

            // Power Distribution Chart
            new Chart(document.getElementById('powerChart'), {
                type: 'bar',
                data: {
                    labels: powerLabels,
                    datasets: [{
                        label: 'Power Distribution (%)',
                        data: powerData,
                        backgroundColor: 'rgba(53, 162, 235, 0.6)',
                        borderColor: 'rgba(53, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, ticks: { stepSize: 10 } }
                    }
                }
            });
        }

        // Call setupCharts on page load
        window.onload = setupCharts;
    </script>
</head>
<body>
    <h1>10GHz EME Stations Statistics</h1>
    <h2>Antenna Size Distribution</h2>
    <canvas id="antennaChart" width="400" height="200"></canvas>
    <h2>Power Distribution</h2>
    <canvas id="powerChart" width="400" height="200"></canvas>
</body>
</html>
