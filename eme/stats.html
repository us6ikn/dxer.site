<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>10GHz EME Stations Statistics</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    canvas { max-width: 800px; margin-bottom: 50px; }
  </style>
</head>
<body>
  <h1>10GHz EME Stations Statistics</h1>

  <h2>Antenna Histogram</h2>
  <canvas id="antennaChart"></canvas>

  <h2>Power Histogram</h2>
  <canvas id="powerChart"></canvas>

  <h2>ERP Histogram</h2>
  <canvas id="erpChart"></canvas>

  <script>
    const FILE_URL_BASE = ''; // e.g. 'https://yourwebsite.com/' if needed

    const files = {
      antenna: FILE_URL_BASE + 'antenna_histogram.txt',
      power: FILE_URL_BASE + 'power_histogram.txt',
      erp: FILE_URL_BASE + 'erp_histogram.txt',
    };

    function parseHistogramData(text) {
      const lines = text.trim().split('\n').slice(1); // Skip header
      const originalLabels = [];
      const labels = [];
      const counts = [];
      for (const line of lines) {
        const parts = line.trim().split(/\t+/);
        if (parts.length >= 2) {
          const label = parts[0];
          const count = parseInt(parts[1], 10);
          originalLabels.push(label);
          if (count > 0) {  // Only include bins where count > 0
            labels.push(label);
            counts.push(count);
          }
        }
      }
      return { labels, counts, originalLabels };
    }

    function plotChart(canvasId, labels, counts, title) {
      new Chart(document.getElementById(canvasId), {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: title,
            data: counts,
            backgroundColor: 'rgba(75, 192, 192, 0.6)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          scales: {
            x: {
              title: { display: true, text: 'Range' },
              type: 'category', // Treat the x-axis as a categorical axis
              labels: labels, // Use the filtered labels for x-axis
            },
            y: { title: { display: true, text: 'Count' }, beginAtZero: true }
          }
        }
      });
    }

    async function loadAndPlot(fileUrl, canvasId, title) {
      try {
        const response = await fetch(fileUrl);
        const text = await response.text();
        const data = parseHistogramData(text);
        plotChart(canvasId, data.labels, data.counts, title);
      } catch (err) {
        console.error(`Error loading ${fileUrl}:`, err);
      }
    }

    // Load all charts
    loadAndPlot(files.antenna, 'antennaChart', 'Antenna Count');
    loadAndPlot(files.power, 'powerChart', 'Power Count');
    loadAndPlot(files.erp, 'erpChart', 'ERP Count');
  </script>
</body>
</html>
