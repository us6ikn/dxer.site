<!DOCTYPE html>
<html>
  <head>
    <title>Moon Position on Google Map</title>
    <style>
      #map {
        height: 100vh;
        width: 100%;
      }
    </style>
    <!-- Load SunCalc -->
    <script src="https://unpkg.com/suncalc/suncalc.js"></script>
  </head>
  <body>
    <div id="map"></div>

    <script>
      // Function to calculate sub-lunar point (simplified)
      function getSubLunarPoint() {
        const now = new Date();
        const moonPos = SunCalc.getMoonPosition(now, 0, 0); // alt/az from lat=0, lon=0

        // Earth's rotation since UTC midnight (in degrees)
        const siderealTime = (now.getUTCHours() * 15 + now.getUTCMinutes() * 0.25);
        
        // Sub-lunar longitude = Right ascension (in radians) converted to degrees - sidereal time
        const lng = (moonPos.azimuth * 180 / Math.PI + 180 + siderealTime) % 360 - 180;
        const lat = moonPos.altitude * 180 / Math.PI;

        return { lat, lng };
      }

      function initMap() {
        const moon = getSubLunarPoint();

        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 2,
          center: moon,
          mapTypeId: "terrain",
        });

        const moonIcon = {
          url: "https://dxer.site/eme/moon-icon.png",
          scaledSize: new google.maps.Size(40, 40),
        };

        new google.maps.Marker({
          position: moon,
          map: map,
          icon: moonIcon,
          title: "Current Moon Position (Sub-lunar point)",
        });
      }
    </script>

    <!-- Google Maps API -->
    <script async
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPRWRoTRhE5TddxBITIhBcKjdQpz2CXRs&callback=initMap">
    </script>
  </body>
</html>
